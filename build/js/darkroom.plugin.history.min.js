!function(window,document,Darkroom,fabric){"use strict";Darkroom.plugins.history=Darkroom.Plugin.extend({initialize:function(){this._initButtons(),this.backHistoryStack=[],this.forwardHistoryStack=[],this._snapshotImage(),this.darkroom.addEventListener("image:change",this._onImageChange.bind(this))},goBack:function(){0!==this.backHistoryStack.length&&(this.forwardHistoryStack.push(this.currentImage),this.currentImage=this.backHistoryStack.pop(),this._applyImage(this.currentImage),this._updateButtons())},goForward:function(){0!==this.forwardHistoryStack.length&&(this.backHistoryStack.push(this.currentImage),this.currentImage=this.forwardHistoryStack.pop(),this._applyImage(this.currentImage),this._updateButtons())},_initButtons:function(){var buttonGroup=this.darkroom.toolbar.createButtonGroup();return this.backButton=buttonGroup.createButton({image:"back",disabled:!0}),this.forwardButton=buttonGroup.createButton({image:"forward",disabled:!0}),this.backButton.addEventListener("click",this.goBack.bind(this)),this.forwardButton.addEventListener("click",this.goForward.bind(this)),this},_updateButtons:function(){this.backButton.disable(0===this.backHistoryStack.length),this.forwardButton.disable(0===this.forwardHistoryStack.length)},_snapshotImage:function(){var image=new Image;image.src=this.darkroom.snapshotImage(),this.currentImage=image},_onImageChange:function(){this.backHistoryStack.push(this.currentImage),this._snapshotImage(),this.forwardHistoryStack.length=0,this._updateButtons()},_applyImage:function(image){var canvas=this.darkroom.canvas,imgInstance=new fabric.Image(image,{selectable:!1,evented:!1,lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0,hasControls:!1,hasBorders:!1});canvas.setWidth(image.width),canvas.setHeight(image.height),this.darkroom.image.remove(),this.darkroom.image=imgInstance,canvas.add(imgInstance),canvas.centerObject(imgInstance),imgInstance.setCoords()}})}(window,document,Darkroom,fabric);
//# sourceMappingURL=darkroom.min.js.map